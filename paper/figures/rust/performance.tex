% Figure: Combined Rust performance (execution time + crossover)
\begin{figure}[t]
\centering
\begin{minipage}{0.47\textwidth}
\centering
\begin{tikzpicture}
\begin{axis}[
    width=0.95\textwidth,
    height=5.5cm,
    xlabel={Percentage of updated values ($k/n$)},
    ylabel={Execution time (\textmu s)},
    xmode=log,
    ymode=log,
    log basis x=10,
    log basis y=10,
    xmin=1, xmax=100000,
    ymin=5, ymax=100000,
    xtick={1, 10, 100, 1000, 10000, 100000},
    xticklabels={.001\%, .01\%, .1\%, 1\%, 10\%, 100\%},
    ytick pos=left,
    grid=major,
    major grid style={line width=0.3pt, draw=gray!30},
    tick label style={font=\scriptsize},
    label style={font=\small},
    title={\textbf{(a) Execution Time ($n=100$K)}},
    legend to name=rustlegend,
    legend style={font=\scriptsize, legend columns=4, column sep=0.3em},
    clip=false,
]

% Crossover vertical lines (drop lines to x-axis)
\draw[orange!60, densely dashed, line width=0.8pt] (axis cs:39,5) -- (axis cs:39,100000);
\draw[green!50!black, densely dashed, line width=0.8pt] (axis cs:31433,5) -- (axis cs:31433,100000);
\draw[purple!50, densely dashed, line width=0.8pt] (axis cs:76974,5) -- (axis cs:76974,100000);

% Crossover labels (above and left of lines)
\node[font=\tiny, orange!80!black, anchor=south east] at (axis cs:50,4.3) {.04\%};
\node[font=\tiny, green!60!black, anchor=south east] at (axis cs:41433,4.3) {31\%};
\node[font=\tiny, purple!70, anchor=south east] at (axis cs:400974,4.3) {77\%};

% FullSort
\addplot[color=gray!70, mark=square*, thick, mark size=1.5pt] 
    table[col sep=comma, x=k, y=native] {\rootdir/figures/rust/execution-time.csv};

% Binary Insertion
\addplot[color=orange!80, mark=triangle*, thick, mark size=1.5pt] 
    table[col sep=comma, x=k, y=bis] {\rootdir/figures/rust/execution-time.csv};

% Extract-Sort-Merge
\addplot[color=purple!70, mark=diamond*, thick, mark size=1.5pt] 
    table[col sep=comma, x=k, y=esm] {\rootdir/figures/rust/execution-time.csv};

% DeltaSort (emphasized)
\addplot[color=green!70!black, mark=*, thick, mark size=2pt, line width=1.2pt] 
    table[col sep=comma, x=k, y=deltasort] {\rootdir/figures/rust/execution-time.csv};

\legend{FullSort, BIS, ESM, \textbf{DeltaSort}}
\end{axis}
\end{tikzpicture}
\end{minipage}%
\hfill%
\begin{minipage}{0.47\textwidth}
\centering
\begin{tikzpicture}
\begin{axis}[
    width=0.95\textwidth,
    height=5.5cm,
    xlabel={Array size ($n$)},
    ylabel={Crossover $k_c / n$ (\%)},
    xmode=log,
    log basis x=10,
    xmin=1000, xmax=1000000,
    ymin=0, ymax=100,
    ytick={0, 20, 40, 60, 80, 100},
    xtick={1000, 10000, 100000, 1000000},
    xticklabels={1K, 10K, \textbf{100K}, 1M},
    grid=both,
    grid style={line width=0.1pt, draw=gray!20},
    major grid style={line width=0.5pt, draw=gray!40},
    tick label style={font=\scriptsize},
    label style={font=\small},
    title={\textbf{(b) Crossover Threshold}},
]

% Highlight line at n=100K
\draw[gray!40, line width=6pt] (axis cs:100000,0) -- (axis cs:100000,100);

% Crossover markers at n=100K
\node[font=\tiny, orange!80!black, anchor=west] at (axis cs:110000,6) {.04\%};
\node[font=\tiny, green!60!black, anchor=west] at (axis cs:110000,36.5) {31\%};
\node[font=\tiny, purple!70, anchor=west] at (axis cs:110000,77) {77\%};

% BIS crossover
\addplot[color=orange!80, mark=triangle*, thick, mark size=2pt, line width=1.2pt] 
    table[col sep=comma, x=n, y=bis] {\rootdir/figures/rust/crossover-all.csv};

% ESM crossover
\addplot[color=purple!70, mark=diamond*, thick, mark size=2pt, line width=1.2pt] 
    table[col sep=comma, x=n, y=esm] {\rootdir/figures/rust/crossover-all.csv};

% DeltaSort crossover
\addplot[color=green!70!black, mark=*, thick, mark size=2pt, line width=1.5pt] 
    table[col sep=comma, x=n, y=deltasort] {\rootdir/figures/rust/crossover-all.csv};

\end{axis}
\end{tikzpicture}
\end{minipage}

\vspace{0.3em}
\ref{rustlegend}
\caption{Rust benchmark results. (a)~Execution time for $n=100$K on log-log scale. Dashed lines mark crossover points where each algorithm loses to FullSort. (b)~Crossover threshold ($k_c/n$) across scales; the shaded line at $n=100$K corresponds to (a). Refer~\appref{sec:appendix-raw-data} for raw data.}
\label{fig:rust-performance}
\end{figure}
