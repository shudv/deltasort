% Figure: Movement cancellation comparison
\begin{figure}[t]
\centering
\begin{tikzpicture}[
    element/.style={minimum width=0.8cm, minimum height=0.6cm, draw, font=\small},
    dirty/.style={element, fill=red!25},
    clean/.style={element, fill=gray!15},
    moved/.style={element, fill=yellow!40},
    arrow/.style={-{Stealth}, thick},
    label/.style={font=\small\bfseries, anchor=east}
]

% Binary Insertion
\node[label] at (-1.5, 0) {BI:};
\node[font=\scriptsize, anchor=east] at (-1.5, -0.4) {Initial};

% Row 1: Initial [1, 8, 5, 2, 9]
\node[clean] at (0*0.9, 0) {1};
\node[dirty] at (1*0.9, 0) {8};
\node[clean] at (2*0.9, 0) {5};
\node[dirty] at (3*0.9, 0) {2};
\node[clean] at (4*0.9, 0) {9};

% Row 2: After extract [1, 5, 9]
\node[font=\scriptsize, anchor=east] at (-1.5, -1.0) {Extract};
\node[clean] at (0*0.9, -1.0) {1};
\node[moved] at (1*0.9, -1.0) {5};
\node[moved] at (2*0.9, -1.0) {9};
\node[element, draw=none] at (3*0.9, -1.0) {};
\node[element, draw=none] at (4*0.9, -1.0) {};
\draw[arrow, blue!60] (2*0.9, -0.35) -- (1*0.9, -0.65);
\draw[arrow, blue!60] (4*0.9, -0.35) -- (2*0.9, -0.65);

% Row 3: Insert 8 [1, 5, 8, 9]
\node[font=\scriptsize, anchor=east] at (-1.5, -2.0) {Insert 8};
\node[clean] at (0*0.9, -2.0) {1};
\node[clean] at (1*0.9, -2.0) {5};
\node[dirty] at (2*0.9, -2.0) {8};
\node[moved] at (3*0.9, -2.0) {9};
\draw[arrow, blue!60] (2*0.9, -1.35) -- (3*0.9, -1.65);

% Row 4: Insert 2 [1, 2, 5, 8, 9]
\node[font=\scriptsize, anchor=east] at (-1.5, -3.0) {Insert 2};
\node[clean] at (0*0.9, -3.0) {1};
\node[dirty] at (1*0.9, -3.0) {2};
\node[moved] at (2*0.9, -3.0) {5};
\node[moved] at (3*0.9, -3.0) {8};
\node[moved] at (4*0.9, -3.0) {9};
\draw[arrow, blue!60] (1*0.9, -2.35) -- (2*0.9, -2.65);
\draw[arrow, blue!60] (2*0.9, -2.35) -- (3*0.9, -2.65);
\draw[arrow, blue!60] (3*0.9, -2.35) -- (4*0.9, -2.65);

% Shift count for BI
\node[font=\scriptsize, text=red!70!black] at (6.5, -1.5) {Element 5:};
\node[font=\scriptsize, text=red!70!black] at (6.5, -2.0) {shifted 3$\times$};

% Separator
\draw[dashed, gray] (-2, -3.7) -- (8, -3.7);

% DeltaSort
\node[label] at (-1.5, -4.4) {DS:};
\node[font=\scriptsize, anchor=east] at (-1.5, -4.8) {Initial};

% Row 1: Initial [1, 8, 5, 2, 9]
\node[clean] at (0*0.9, -4.4) {1};
\node[dirty] at (1*0.9, -4.4) {8};
\node[clean] at (2*0.9, -4.4) {5};
\node[dirty] at (3*0.9, -4.4) {2};
\node[clean] at (4*0.9, -4.4) {9};

% Row 2: After Phase 1 [1, 2, 5, 8, 9]
\node[font=\scriptsize, anchor=east] at (-1.5, -5.4) {Phase 1};
\node[clean] at (0*0.9, -5.4) {1};
\node[dirty] at (1*0.9, -5.4) {2};
\node[clean] at (2*0.9, -5.4) {5};
\node[dirty] at (3*0.9, -5.4) {8};
\node[clean] at (4*0.9, -5.4) {9};

% Arrows showing value reassignment (not movement)
\draw[arrow, green!60!black, dashed] (1*0.9+0.15, -4.75) to[out=-60,in=60] (1*0.9+0.15, -5.05);
\draw[arrow, green!60!black, dashed] (3*0.9-0.15, -4.75) to[out=-120,in=120] (3*0.9-0.15, -5.05);
\node[font=\tiny, text=green!50!black] at (2*0.9, -4.9) {swap values};

% Row 3: Phase 2-3: Both STABLE
\node[font=\scriptsize, anchor=east] at (-1.5, -6.4) {Phase 2-3};
\node[clean] at (0*0.9, -6.4) {1};
\node[dirty] at (1*0.9, -6.4) {2};
\node[clean] at (2*0.9, -6.4) {5};
\node[dirty] at (3*0.9, -6.4) {8};
\node[clean] at (4*0.9, -6.4) {9};
\node[font=\tiny, text=green!50!black] at (1*0.9, -6.9) {STABLE};
\node[font=\tiny, text=green!50!black] at (3*0.9, -6.9) {STABLE};

% Shift count for DS
\node[font=\scriptsize, text=green!50!black] at (6.5, -5.4) {Element 5:};
\node[font=\scriptsize, text=green!50!black] at (6.5, -5.9) {shifted 0$\times$};

\end{tikzpicture}
\caption{Movement cancellation comparison. Binary Insertion (top) extracts then reinserts,
causing element 5 to shift multiple times. DeltaSort (bottom) reassigns values in Phase 1
so that both dirty elements are immediately STABLE---element 5 never moves.}
\label{fig:cancellation}
\end{figure}
