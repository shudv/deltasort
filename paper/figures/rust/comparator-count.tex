% Figure: Comparator invocation count comparison
\begin{figure}[H]
\centering
\begin{tikzpicture}
\begin{axis}[
    width=0.92\textwidth,
    height=6cm,
    xlabel={Number of updated values ($k$)},
    ylabel={Comparator invocations},
    xmode=log,
    ymode=log,
    log basis x=10,
    log basis y=10,
    xmin=0.8, xmax=25000,
    ymin=10, ymax=1000000,
    xtick={1, 10, 100, 1000, 10000},
    xticklabels={1, 10, 100, 1K, 10K},
    ytick={10, 100, 1000, 10000, 100000, 1000000},
    yticklabels={10, 100, 1K, 10K, 100K, 1M},
    legend pos=south east,
    legend style={font=\small},
    grid=both,
    grid style={line width=0.1pt, draw=gray!30},
    major grid style={line width=0.2pt, draw=gray!50},
]

% Native Sort
\addplot[color=gray!70, mark=square*, thick, mark size=2.5pt] coordinates {
    (1, 65100) (2, 77260) (5, 118900) (10, 145000) (20, 193060)
    (50, 270800) (100, 333960) (200, 456100) (500, 627720)
    (1000, 691310) (2000, 705350) (5000, 720260) (10000, 747150) (20000, 790100)
};

% Binary Insertion
\addplot[color=orange!80, mark=triangle*, thick, mark size=2.5pt] coordinates {
    (1, 17) (2, 34) (5, 85) (10, 170) (20, 340)
    (50, 850) (100, 1700) (200, 3400) (500, 8500)
    (1000, 17000) (2000, 34000) (5000, 85000) (10000, 170000) (20000, 337230)
};

% Extract-Sort-Merge
\addplot[color=purple!70, mark=diamond*, thick, mark size=2.5pt] coordinates {
    (1, 15110) (2, 35880) (5, 47980) (10, 43160) (20, 46590)
    (50, 48780) (100, 50540) (200, 51610) (500, 54670)
    (1000, 60910) (2000, 73790) (5000, 116240) (10000, 192560) (20000, 355230)
};

% DeltaSort
\addplot[color=green!70!black, mark=*, thick, mark size=2.5pt, line width=1.5pt] coordinates {
    (1, 17) (2, 32) (5, 79) (10, 161) (20, 371)
    (50, 821) (100, 1880) (200, 3760) (500, 10070)
    (1000, 20740) (2000, 41180) (5000, 116200) (10000, 212170) (20000, 456180)
};

\legend{NativeSort, BIS, ESM, \textbf{DeltaSort}}
\end{axis}
\end{tikzpicture}
\caption{Comparator invocation count for $n = 50$K. DeltaSort and BIS
both achieve $O(k \log n)$ comparisons, while NativeSort uses $O(n \log n)$ regardless
of $k$, and ESM uses $O(k \log k + n)$. The 10--40\% higher comparison counts for DeltaSort
vs BIS confirm that movement confinement (Lemma~\ref{lem:confinement}) is the major factor in DeltaSort speedup.}
\label{fig:rust-comparator-count}
\end{figure}
