\begin{figure}[t]
  \centering
  \begin{tikzpicture}
    \begin{axis}[
      width=0.85\columnwidth,
      height=0.6\columnwidth,
      xlabel={$k/n$ (\%)},
      ylabel={Segments per $k$},
      xmin=0,
      xmax=55,
      ymin=0,
      legend pos=north east,
      legend style={font=\small},
      grid=major,
      grid style={gray!30},
      tick label style={font=\small},
      label style={font=\small},
    ]
    
    % n = 1,000
    \addplot[
      color=blue,
      mark=*,
      mark size=1.5pt,
      thick,
    ] table[
      x=k_percent,
      y=n1000,
      col sep=comma,
    ] {\rootdir/figures/segments-per-k.csv};
    \addlegendentry{$n = 1{,}000$}
    
    % n = 10,000
    \addplot[
      color=red,
      mark=square*,
      mark size=1.5pt,
      thick,
    ] table[
      x=k_percent,
      y=n10000,
      col sep=comma,
    ] {\rootdir/figures/segments-per-k.csv};
    \addlegendentry{$n = 10{,}000$}
    
    % n = 100,000
    \addplot[
      color=green!60!black,
      mark=triangle*,
      mark size=1.5pt,
      thick,
    ] table[
      x=k_percent,
      y=n100000,
      col sep=comma,
    ] {\rootdir/figures/segments-per-k.csv};
    \addlegendentry{$n = 100{,}000$}
    
    % n = 1,000,000
    \addplot[
      color=orange,
      mark=diamond*,
      mark size=1.5pt,
      thick,
    ] table[
      x=k_percent,
      y=n1000000,
      col sep=comma,
    ] {\rootdir/figures/segments-per-k.csv};
    \addlegendentry{$n = 1{,}000{,}000$}
    
    \end{axis}
  \end{tikzpicture}
  \caption{Segments per violation ($s/k$) as a function of the update ratio $k/n$.
    Each update creates on average ${\approx}0.3$--$0.5$ new segments, with the ratio
    decreasing as more elements are updated due to segment merging.
    The relationship is independent of array size $n$.}
  \label{fig:segments-per-k}
\end{figure}
